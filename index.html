
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>استمارة المعلومات للمسابقات</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .form-section {
            background: white;
            border-radius: 0.75rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        .section-header {
            background-color: #1e293b;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 0.4rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            display: inline-block;
            font-size: 1rem;
        }
        input, select, textarea {
            border: 2px solid #e2e8f0;
            padding: 0.7rem;
            border-radius: 0.5rem;
            width: 100%;
            margin-top: 0.4rem;
            transition: all 0.2s;
            font-weight: 600;
            background-color: #fff;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }
        .label-title {
            font-weight: 700;
            color: #475569;
            display: block;
            font-size: 0.85rem;
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        const wilayas = [
            "01- أدرار", "02- الشلف", "03- الأغواط", "04- أم البواقي", "05- باتنة", "06- بجاية", "07- بسكرة", "08- بشار", "09- البليدة", "10- البويرة",
            "11- تمنراست", "12- تبسة", "13- تلمسان", "14- تيارت", "15- تيزي وزو", "16- الجزائر", "17- الجلفة", "18- جيجل", "19- سطيف", "20- سعيدة",
            "21- سكيكدة", "22- سيدي بلعباس", "23- عنابة", "24- قالمة", "25- قسنطينة", "26- المدية", "27- مستغانم", "28- المسيلة", "29- معسكر", "30- ورقلة",
            "31- وهران", "32- البيض", "33- إليزي", "34- برج بوعريريج", "35- بومرداس", "36- الطارف", "37- تندوف", "38- تسمسيلت", "39- الوادي", "40- خنشلة",
            "41- سوق أهراس", "42- تيبازة", "43- ميلة", "44- عين الدفلى", "45- النعامة", "46- عين تموشنت", "47- غرداية", "48- غليزان", "49- تيميمون", "50- برج باجي مختار",
            "51- أولاد جلال", "52- بني عباس", "53- عين صالح", "54- عين قزام", "55- تقرت", "56- جانت", "57- المغير", "58- المنيعة"
        ];

        // خريطة البلديات الموسعة مع خيار "أخرى"
        const communesMap = {
            "03- الأغواط": ["الأغواط", "قصر الحيران", "بن ناصر بن شهرة", "سيدي مخلوف", "حاسي الدلاعة", "حاسي الرمل", "عين ماضي", "تاجموت", "الخنق", "قلتة سيدي سعد", "أفلو", "البيضاء", "سيدي بوزيد", "الغيشة", "بريدة", "الحويطة", "تاجرونة", "سبقاق", "تاويالة", "وادي مرة", "وادي مزي", "العسافية", "بن يعقوب", "عين سيدي علي"],
            "17- الجلفة": ["الجلفة", "عين وسارة", "حاسي بحبح", "مسعد", "الشارف", "بيرين", "دار الشيوخ", "حد الصحاري", "الإدريسية", "عين الإبل", "تعظميت", "سيدي لعجل"],
            "16- الجزائر": ["الجزائر الوسطى", "سيدي امحمد", "المدنية", "بلوزداد", "باب الوادي", "بولوغين", "بوزريعة", "بئر مراد رايس", "الحراش", "الدار البيضاء", "دالي إبراهيم", "الشراقة"],
            "default": ["مقر الولاية", "بلدية أخرى (كتابة يدوية)"]
        };

        const App = () => {
            const [step, setStep] = useState(1);
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [submitted, setSubmitted] = useState(false);

            const [formData, setFormData] = useState({
                directorate: '', requestedRank: '', teachingSubject: '',
                nin: '', lastNameAr: '', firstNameAr: '', lastNameLat: '', firstNameLat: '',
                fatherName: '', motherFirstName: '', motherLastName: '', birthDate: '',
                birthWilaya: '', birthCommune: '', birthCommuneManual: '', gender: '',
                maritalStatus: 'أعزب / عزباء', childrenCount: '0', 
                residenceWilaya: '', residenceCommune: '', residenceCommuneManual: '', fullAddress: '', phoneNumber: '',
                militaryStatus: '', docRefNum: '', docIssueDate: '', docEndDate: '', serviceStartDate: '', serviceEndDate: '',
                degreeName: '', specialty: '', degreeNum: '', graduationDate: '', issuingInstitution: '', trainingDuration: '', startYear: '', endYear: '', degreeGrade: '', 
                isEnsaGraduate: false, isFirstInClass: false, firstInClassDocNum: '', firstInClassDocDate: '', firstInClassIssuer: '',
                gpa: '', thesisGrade: '',
                semesters: Array(5).fill(null).map(() => ({ s1: '', s2: '', annual: '' })),
                otherDegreeName: '', otherDegreeSpecialty: '', otherDegreeIssuer: '', otherDegreeSemesters: '', otherDegreeFromYear: '', otherDegreeToYear: '',
                publicationNature: '', publicationDate: '', journalName: '', journalIssue: '', publicationLink: '',
                expJob: '', expInstitution: '', expApprovedDegree: '', expContractNum: '', expContractDate: '', expFrom: '', expTo: '', expEndReason: '',
                isEmployed: false, currentRank: '', firstAppointmentDate: '', rankAppointmentDate: '', currentGrade: '', adminRefNum: '', adminRefDate: '', signingAuthority: '', adminPhone: '', adminAddress: '',
                email: '', attachedDocs: []
            });

            // منطق التأشير التلقائي على الوثائق الملحقة (Automatic Checking Logic)
            useEffect(() => {
                const docs = [];
                // 1. بطاقة الإقامة: إذا تم اختيار ولاية وبلدية
                if (formData.residenceWilaya && (formData.residenceCommune || formData.residenceCommuneManual)) {
                    docs.push("بطاقة الإقامة");
                }
                // 2. الخدمة الوطنية: إذا كان ذكر وتم تعبئة الوضعية
                if (formData.gender === 'male' && formData.militaryStatus) {
                    docs.push("وثيقة الخدمة الوطنية");
                }
                // 3. نسخة من الشهادة: إذا تم تعبئة بيانات الشهادة
                if (formData.degreeName && formData.degreeNum && formData.graduationDate) {
                    docs.push("نسخة من الشهادة (المؤهل)");
                }
                // 4. كشوف النقاط: إذا تم تعبئة أي معدل سنوي في المسار الدراسي
                if (formData.semesters.some(s => s.annual && s.annual.trim() !== "")) {
                    docs.push("كشوف النقاط للمسار الدراسي");
                }
                // 5. منشورات علمية وشهادات عليا: إذا تم تعبئة بياناتها
                if (formData.otherDegreeName || formData.publicationNature) {
                    docs.push("ملف المنشورات والشهادات العليا");
                }
                // 6. شهادات العمل: إذا تم تعبئة منصب سابق
                if (formData.expJob && formData.expJob.trim() !== "") {
                    docs.push("شهادات العمل (الخبرة)");
                }
                // 7. ترخيص المشاركة: إذا كان موظفاً حالياً
                if (formData.isEmployed) {
                    docs.push("ترخيص المشاركة (للموظفين)");
                }
                
                setFormData(prev => ({ ...prev, attachedDocs: docs }));
            }, [
                formData.residenceWilaya, formData.residenceCommune, formData.residenceCommuneManual, 
                formData.gender, formData.militaryStatus, formData.degreeName, formData.degreeNum, 
                formData.graduationDate, formData.semesters, formData.otherDegreeName, 
                formData.publicationNature, formData.expJob, formData.isEmployed
            ]);

            const rankOptions = ["أستاذ مدرسة ابتدائية", "أستاذ تعليم متوسط", "أستاذ تعليم ثانوي"];
            const degreeTypes = ["ليسانس", "ماستر", "دراسات عليا", "مهندس"];
            const gradeOptions = ["مقبول", "حسن", "حسن جداً", "امتياز"];

            const birthCommunes = useMemo(() => communesMap[formData.birthWilaya] || communesMap["default"], [formData.birthWilaya]);
            const residenceCommunes = useMemo(() => communesMap[formData.residenceWilaya] || communesMap["default"], [formData.residenceWilaya]);

            const handleChange = (e) => {
                const { name, value, type, checked } = e.target;
                if (name === 'nin' && !/^\d*$/.test(value)) return;
                if ((name === 'lastNameLat' || name === 'firstNameLat') && !/^[a-zA-Z\s]*$/.test(value)) return;
                setFormData(prev => ({ ...prev, [name]: type === 'checkbox' ? checked : value }));
            };

            const handleSemesterChange = (index, field, value) => {
                const newSemesters = [...formData.semesters];
                newSemesters[index] = { ...newSemesters[index], [field]: value };
                setFormData(prev => ({ ...prev, semesters: newSemesters }));
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsSubmitting(true);

                const finalBirthCommune = formData.birthCommune === 'بلدية أخرى (كتابة يدوية)' ? formData.birthCommuneManual : formData.birthCommune;
                const finalResidenceCommune = formData.residenceCommune === 'بلدية أخرى (كتابة يدوية)' ? formData.residenceCommuneManual : formData.residenceCommune;

                const payload = {
                    "--- الهوية والاتصال ---": "",
                    "رقم التعريف الوطني": formData.nin,
                    "الاسم واللقب": `${formData.firstNameAr} ${formData.lastNameAr}`,
                    "اسم الأب والأم": `${formData.fatherName} ابن ${formData.motherFirstName} ${formData.motherLastName}`,
                    "الميلاد": `${formData.birthDate} في ${finalBirthCommune} (${formData.birthWilaya})`,
                    "الجنس": formData.gender === 'male' ? 'ذكر' : 'أنثى',
                    "الحالة العائلية": `${formData.maritalStatus} (الأولاد: ${formData.maritalStatus === 'متزوج(ة)' ? formData.childrenCount : "0"})`,
                    "الإقامة": `${formData.residenceWilaya} - ${finalResidenceCommune}`,
                    "العنوان والاتصال": `${formData.fullAddress} | هاتف: ${formData.phoneNumber} | بريد: ${formData.email}`,
                    "--- المنصب والشهادة ---": "",
                    "الرتبة": formData.requestedRank,
                    "المادة": formData.teachingSubject,
                    "الشهادة": `${formData.degreeName} - ${formData.specialty} (${formData.issuingInstitution})`,
                    "المعدل والتقدير": `${formData.gpa} - تقدير: ${formData.degreeGrade}`,
                    "--- الخدمة الوطنية ---": formData.gender === 'male' ? formData.militaryStatus : "غير معني",
                    "--- الوثائق التلقائية ---": formData.attachedDocs.join(" | "),
                    "_subject": `ملف مسابقة: ${formData.firstNameAr} ${formData.lastNameAr}`,
                    "_template": "table",
                    "_captcha": "false"
                };

                try {
                    const response = await fetch("https://formsubmit.co/ajax/ksarinfo.impr@gmail.com", {
                        method: "POST", headers: { "Content-Type": "application/json", "Accept": "application/json" },
                        body: JSON.stringify(payload)
                    });
                    if (response.ok) setSubmitted(true);
                    else alert("يرجى تفعيل الاستمارة من بريدك الإلكتروني.");
                } catch { alert("خطأ في الاتصال بالإنترنت."); }
                finally { setIsSubmitting(false); }
            };

            if (submitted) {
                return (
                    <div className="min-h-screen flex items-center justify-center p-6 text-center animate-fade-in">
                        <div className="bg-white p-12 rounded-2xl shadow-2xl max-w-xl w-full border-t-8 border-green-600">
                            <div className="text-green-600 text-7xl mb-6">✓</div>
                            <h1 className="text-3xl font-black text-gray-800 mb-4">تم الإرسال بنجاح</h1>
                            <p className="text-gray-600 font-bold text-lg mb-8 leading-relaxed">شكراً {formData.firstNameAr}. تم استلام معلوماتك، يرجى تقديم ملفك الورقي في أقرب وقت.</p>
                            <button onClick={() => window.location.reload()} className="bg-gray-800 text-white px-10 py-4 rounded-xl font-black hover:bg-gray-700 transition w-full shadow-lg">تقديم طلب آخر</button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="max-w-5xl mx-auto py-12 px-4">
                    <header className="mb-10 text-center bg-white border-b-8 border-gray-800 p-8 rounded-xl shadow-lg">
                        <h1 className="text-3xl md:text-4xl font-black text-gray-800 mb-2">استمارة المعلومات للمسابقات</h1>
                        <p className="text-xl font-bold text-blue-600 italic">على أساس الشهادة</p>
                    </header>

                    <div className="mb-10 flex items-center justify-between text-xs md:text-sm font-black text-gray-400 gap-2 pb-2 overflow-x-auto whitespace-nowrap scrollbar-hide">
                        {[1, 2, 3, 4, 5, 6].map((s) => (
                            <div key={s} className={`flex-1 text-center pb-3 border-b-4 transition-all ${step >= s ? 'border-blue-600 text-blue-600' : 'border-gray-200'}`}>المرحلة {s}</div>
                        ))}
                    </div>

                    <form onSubmit={handleSubmit} className="space-y-6">
                        {step === 1 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">1. معلومات المنصب المترشح له</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div><label className="label-title">مديرية التربية لولاية</label>
                                            <select name="directorate" required value={formData.directorate} onChange={handleChange}>
                                                <option value="">-- اختر الولاية --</option>
                                                {wilayas.map(w => <option key={w} value={w}>{w}</option>)}
                                            </select>
                                        </div>
                                        <div><label className="label-title">الرتبة المطلوبة</label>
                                            <select name="requestedRank" required value={formData.requestedRank} onChange={handleChange}>
                                                <option value="">-- اختر الرتبة --</option>
                                                {rankOptions.map(r => <option key={r} value={r}>{r}</option>)}
                                            </select>
                                        </div>
                                        <div className="md:col-span-2"><label className="label-title">مادة التدريس</label><input type="text" name="teachingSubject" placeholder="لغة عربية، فيزياء..." required value={formData.teachingSubject} onChange={handleChange} /></div>
                                    </div>
                                </div>

                                <div className="form-section">
                                    <h2 className="section-header">2. الهوية والمعلومات الشخصية</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div className="md:col-span-2"><label className="label-title">رقم التعريف الوطني (18 رقم)</label><input type="text" name="nin" maxLength="18" placeholder="000000000000000000" required value={formData.nin} onChange={handleChange} /></div>
                                        <div><label className="label-title">اللقب (بالعربية)</label><input type="text" name="lastNameAr" required value={formData.lastNameAr} onChange={handleChange} /></div>
                                        <div><label className="label-title">الاسم (بالعربية)</label><input type="text" name="firstNameAr" required value={formData.firstNameAr} onChange={handleChange} /></div>
                                        <div><label className="label-title">اللقب (باللاتينية)</label><input type="text" name="lastNameLat" dir="ltr" required value={formData.lastNameLat} onChange={handleChange} /></div>
                                        <div><label className="label-title">الاسم (باللاتينية)</label><input type="text" name="firstNameLat" dir="ltr" required value={formData.firstNameLat} onChange={handleChange} /></div>
                                        <div><label className="label-title">اسم الأب</label><input type="text" name="fatherName" required value={formData.fatherName} onChange={handleChange} /></div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">اسم الأم</label><input type="text" name="motherFirstName" required value={formData.motherFirstName} onChange={handleChange} /></div>
                                            <div><label className="label-title">لقب الأم</label><input type="text" name="motherLastName" required value={formData.motherLastName} onChange={handleChange} /></div>
                                        </div>
                                        <div><label className="label-title">تاريخ الميلاد</label><input type="date" name="birthDate" required value={formData.birthDate} onChange={handleChange} /></div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">ولاية الميلاد</label>
                                                <select name="birthWilaya" required value={formData.birthWilaya} onChange={handleChange}>
                                                    <option value="">-- اختر --</option>
                                                    {wilayas.map(w => <option key={w} value={w}>{w}</option>)}
                                                </select>
                                            </div>
                                            <div><label className="label-title">بلدية الميلاد</label>
                                                <select name="birthCommune" required value={formData.birthCommune} onChange={handleChange} disabled={!formData.birthWilaya}>
                                                    <option value="">-- اختر --</option>
                                                    {birthCommunes.map(c => <option key={c} value={c}>{c}</option>)}
                                                </select>
                                            </div>
                                        </div>
                                        {formData.birthCommune === 'بلدية أخرى (كتابة يدوية)' && (
                                            <div className="md:col-span-2"><label className="label-title">اكتب بلدية الميلاد يدوياً</label><input type="text" name="birthCommuneManual" required value={formData.birthCommuneManual} onChange={handleChange} /></div>
                                        )}
                                        <div><label className="label-title">الجنس</label>
                                            <div className="flex gap-6 mt-3">
                                                <label className="flex items-center gap-2 font-bold cursor-pointer"><input type="radio" name="gender" value="male" checked={formData.gender === 'male'} onChange={handleChange} required /> ذكر</label>
                                                <label className="flex items-center gap-2 font-bold cursor-pointer"><input type="radio" name="gender" value="female" checked={formData.gender === 'female'} onChange={handleChange} /> أنثى</label>
                                            </div>
                                        </div>
                                        <div><label className="label-title">الحالة العائلية</label>
                                            <select name="maritalStatus" required value={formData.maritalStatus} onChange={handleChange}>
                                                {["أعزب / عزباء", "متزوج(ة)", "مطلق(ة)", "أرمل(ة)"].map(m => <option key={m} value={m}>{m}</option>)}
                                            </select>
                                        </div>
                                        {formData.maritalStatus === 'متزوج(ة)' && (
                                            <div><label className="label-title">عدد الأولاد</label><input type="number" name="childrenCount" min="0" value={formData.childrenCount} onChange={handleChange} /></div>
                                        )}
                                        
                                        <div className="md:col-span-2 border-t pt-4">
                                            <h3 className="font-bold text-blue-700 mb-2">معلومات الإقامة والاتصال</h3>
                                        </div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">ولاية الإقامة</label>
                                                <select name="residenceWilaya" required value={formData.residenceWilaya} onChange={handleChange}>
                                                    <option value="">-- اختر --</option>
                                                    {wilayas.map(w => <option key={w} value={w}>{w}</option>)}
                                                </select>
                                            </div>
                                            <div><label className="label-title">بلدية الإقامة</label>
                                                <select name="residenceCommune" required value={formData.residenceCommune} onChange={handleChange} disabled={!formData.residenceWilaya}>
                                                    <option value="">-- اختر --</option>
                                                    {residenceCommunes.map(c => <option key={c} value={c}>{c}</option>)}
                                                </select>
                                            </div>
                                        </div>
                                        {formData.residenceCommune === 'بلدية أخرى (كتابة يدوية)' && (
                                            <div className="md:col-span-2"><label className="label-title">اكتب بلدية الإقامة يدوياً</label><input type="text" name="residenceCommuneManual" required value={formData.residenceCommuneManual} onChange={handleChange} /></div>
                                        )}
                                        <div className="md:col-span-2"><label className="label-title">رقم الهاتف الشخصي</label><input type="text" name="phoneNumber" required value={formData.phoneNumber} onChange={handleChange} /></div>
                                        <div className="md:col-span-2"><label className="label-title">العنوان التفصيلي الحالي</label><input type="text" name="fullAddress" placeholder="الحي، الشارع، رقم الباب..." required value={formData.fullAddress} onChange={handleChange} /></div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 2 && (
                            <div className="animate-fade-in space-y-6">
                                {formData.gender === 'male' && (
                                    <div className="form-section">
                                        <h2 className="section-header">3. الخدمة الوطنية (للذكور فقط)</h2>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div className="md:col-span-2 flex flex-wrap gap-4">
                                                {["مؤدى", "معفى", "مؤجل"].map(s => <label key={s} className="flex items-center gap-2 font-bold p-3 border rounded-lg cursor-pointer"><input type="radio" name="militaryStatus" value={s} checked={formData.militaryStatus === s} onChange={handleChange} /> {s}</label>)}
                                            </div>
                                            <div><label className="label-title">رقم الوثيقة</label><input type="text" name="docRefNum" value={formData.docRefNum} onChange={handleChange} /></div>
                                            <div className="grid grid-cols-2 gap-2">
                                                <div><label className="label-title">تاريخ الإصدار</label><input type="date" name="docIssueDate" value={formData.docIssueDate} onChange={handleChange} /></div>
                                                <div><label className="label-title">تاريخ الانتهاء</label><input type="date" name="docEndDate" value={formData.docEndDate} onChange={handleChange} /></div>
                                            </div>
                                            <div><label className="label-title">تاريخ بداية الخدمة</label><input type="date" name="serviceStartDate" value={formData.serviceStartDate} onChange={handleChange} /></div>
                                            <div><label className="label-title">تاريخ نهاية الخدمة</label><input type="date" name="serviceEndDate" value={formData.serviceEndDate} onChange={handleChange} /></div>
                                        </div>
                                    </div>
                                )}

                                <div className="form-section">
                                    <h2 className="section-header">4. الشهادة والمؤهل العلمي</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div><label className="label-title">تسمية الشهادة</label>
                                            <select name="degreeName" required value={formData.degreeName} onChange={handleChange}>
                                                <option value="">-- اختر --</option>
                                                {degreeTypes.map(d => <option key={d} value={d}>{d}</option>)}
                                            </select>
                                        </div>
                                        <div><label className="label-title">الشعبة / التخصص</label><input type="text" name="specialty" required value={formData.specialty} onChange={handleChange} /></div>
                                        <div><label className="label-title">رقم الشهادة</label><input type="text" name="degreeNum" required value={formData.degreeNum} onChange={handleChange} /></div>
                                        <div><label className="label-title">تاريخ التخرج</label><input type="date" name="graduationDate" required value={formData.graduationDate} onChange={handleChange} /></div>
                                        <div className="md:col-span-2"><label className="label-title">المؤسسة المسلمة للشهادة</label><input type="text" name="issuingInstitution" required value={formData.issuingInstitution} onChange={handleChange} /></div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">سنة البداية</label><input type="text" name="startYear" maxLength="4" placeholder="2018" value={formData.startYear} onChange={handleChange} /></div>
                                            <div><label className="label-title">سنة النهاية</label><input type="text" name="endYear" maxLength="4" placeholder="2023" value={formData.endYear} onChange={handleChange} /></div>
                                        </div>
                                        <div><label className="label-title">تقدير الشهادة</label>
                                            <select name="degreeGrade" value={formData.degreeGrade} onChange={handleChange}>
                                                <option value="">-- اختر التقدير --</option>
                                                {gradeOptions.map(g => <option key={g} value={g}>{g}</option>)}
                                            </select>
                                        </div>
                                        <div className="md:col-span-2 border-t pt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <label className="flex items-center gap-2 font-bold cursor-pointer"><input type="checkbox" name="isEnsaGraduate" checked={formData.isEnsaGraduate} onChange={handleChange} /> خريج مدرسة وطنية عليا</label>
                                            <label className="flex items-center gap-2 font-bold cursor-pointer"><input type="checkbox" name="isFirstInClass" checked={formData.isFirstInClass} onChange={handleChange} /> الأول في الدفعة</label>
                                        </div>
                                        {formData.isFirstInClass && (
                                            <div className="md:col-span-2 bg-gray-50 p-4 rounded-xl border-2 border-dashed border-gray-200 grid grid-cols-1 md:grid-cols-3 gap-4">
                                                <div><label className="label-title">رقم الوثيقة</label><input type="text" name="firstInClassDocNum" value={formData.firstInClassDocNum} onChange={handleChange} /></div>
                                                <div><label className="label-title">تاريخ الإصدار</label><input type="date" name="firstInClassDocDate" value={formData.firstInClassDocDate} onChange={handleChange} /></div>
                                                <div><label className="label-title">الجهة المسلمة</label><input type="text" name="firstInClassIssuer" value={formData.firstInClassIssuer} onChange={handleChange} /></div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 3 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">5. المسار الدراسي (كشوف النقاط)</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                        <div><label className="label-title">المعدل العام للمسار الدراسي</label><input type="text" name="gpa" placeholder="00.00" value={formData.gpa} onChange={handleChange} /></div>
                                        <div><label className="label-title">علامة مذكرة التخرج (إن وجدت)</label><input type="text" name="thesisGrade" value={formData.thesisGrade} onChange={handleChange} /></div>
                                    </div>
                                    <div className="overflow-x-auto rounded-xl border">
                                        <table className="w-full text-center font-bold">
                                            <thead className="bg-gray-800 text-white">
                                                <tr><th className="p-4">السنة</th><th className="p-4">س 1</th><th className="p-4">س 2</th><th className="p-4">السنوي</th></tr>
                                            </thead>
                                            <tbody className="divide-y">
                                                {[1, 2, 3, 4, 5].map((y, idx) => (
                                                    <tr key={y} className="hover:bg-gray-50">
                                                        <td className="p-4 bg-gray-50">السنة {y}</td>
                                                        <td><input type="text" className="w-full border-none text-center bg-transparent" value={formData.semesters[idx].s1} onChange={(e) => handleSemesterChange(idx, 's1', e.target.value)} /></td>
                                                        <td><input type="text" className="w-full border-none text-center bg-transparent" value={formData.semesters[idx].s2} onChange={(e) => handleSemesterChange(idx, 's2', e.target.value)} /></td>
                                                        <td><input type="text" className="w-full border-none text-center bg-transparent" value={formData.semesters[idx].annual} onChange={(e) => handleSemesterChange(idx, 'annual', e.target.value)} /></td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 4 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">6. شهادات عليا أخرى ومنشورات</h2>
                                    <div className="space-y-6">
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pb-6 border-b">
                                            <h3 className="md:col-span-2 font-black text-blue-800">شهادة عليا إضافية (إن وجدت):</h3>
                                            <div><label className="label-title">تسمية الشهادة</label><input type="text" name="otherDegreeName" value={formData.otherDegreeName} onChange={handleChange} /></div>
                                            <div><label className="label-title">الشعبة والتخصص</label><input type="text" name="otherDegreeSpecialty" value={formData.otherDegreeSpecialty} onChange={handleChange} /></div>
                                            <div><label className="label-title">الجهة المسلمة</label><input type="text" name="otherDegreeIssuer" value={formData.otherDegreeIssuer} onChange={handleChange} /></div>
                                            <div className="grid grid-cols-2 gap-2">
                                                <div><label className="label-title">من سنة</label><input type="text" name="otherDegreeFromYear" maxLength="4" value={formData.otherDegreeFromYear} onChange={handleChange} /></div>
                                                <div><label className="label-title">إلى سنة</label><input type="text" name="otherDegreeToYear" maxLength="4" value={formData.otherDegreeToYear} onChange={handleChange} /></div>
                                            </div>
                                        </div>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pt-4">
                                            <h3 className="md:col-span-2 font-black text-blue-800">المنشورات والأعمال العلمية:</h3>
                                            <div><label className="label-title">طبيعة العمل (مقال، ملتقى...)</label><input type="text" name="publicationNature" placeholder="شرح (مثلاً: مقال وطني)" value={formData.publicationNature} onChange={handleChange} /></div>
                                            <div><label className="label-title">تاريخ النشر / الدراسة</label><input type="date" name="publicationDate" value={formData.publicationDate} onChange={handleChange} /></div>
                                            <div><label className="label-title">اسم المجلة / الملتقى</label><input type="text" name="journalName" value={formData.journalName} onChange={handleChange} /></div>
                                            <div><label className="label-title">العدد والمجلد</label><input type="text" name="journalIssue" value={formData.journalIssue} onChange={handleChange} /></div>
                                            <div className="md:col-span-2"><label className="label-title">رابط النشر (URL)</label><input type="text" name="publicationLink" dir="ltr" value={formData.publicationLink} onChange={handleChange} /></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 5 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">7. الخبرة المهنية والوضعية المهنية</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pb-6 border-b">
                                        <h3 className="md:col-span-2 font-black text-blue-800">الخبرة المهنية السابقة:</h3>
                                        <div><label className="label-title">الوظيفة أو المنصب</label><input type="text" name="expJob" value={formData.expJob} onChange={handleChange} /></div>
                                        <div><label className="label-title">المؤسسة / الإدارة</label><input type="text" name="expInstitution" value={formData.expInstitution} onChange={handleChange} /></div>
                                        <div><label className="label-title">الشهادة المعتمدة للتوظيف</label><input type="text" name="expApprovedDegree" value={formData.expApprovedDegree} onChange={handleChange} /></div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">رقم العقد</label><input type="text" name="expContractNum" value={formData.expContractNum} onChange={handleChange} /></div>
                                            <div><label className="label-title">تاريخ العقد</label><input type="date" name="expContractDate" value={formData.expContractDate} onChange={handleChange} /></div>
                                        </div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div><label className="label-title">من تاريخ</label><input type="date" name="expFrom" value={formData.expFrom} onChange={handleChange} /></div>
                                            <div><label className="label-title">إلى تاريخ</label><input type="date" name="expTo" value={formData.expTo} onChange={handleChange} /></div>
                                        </div>
                                        <div className="md:col-span-2"><label className="label-title">سبب إنهاء علاقة العمل</label><input type="text" name="expEndReason" value={formData.expEndReason} onChange={handleChange} /></div>
                                    </div>

                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 pt-6">
                                        <div className="md:col-span-2"><label className="flex items-center gap-2 font-bold cursor-pointer p-4 border rounded-lg bg-blue-50 border-blue-200"><input type="checkbox" name="isEmployed" checked={formData.isEmployed} onChange={handleChange} /> هل تشغل وظيفة حالياً؟</label></div>
                                        {formData.isEmployed && (
                                            <>
                                                <div><label className="label-title">الرتبة المشغولة حالياً</label><input type="text" name="currentRank" required={formData.isEmployed} value={formData.currentRank} onChange={handleChange} /></div>
                                                <div className="grid grid-cols-2 gap-2">
                                                    <div><label className="label-title">تاريخ أول تعيين</label><input type="date" name="firstAppointmentDate" value={formData.firstAppointmentDate} onChange={handleChange} /></div>
                                                    <div><label className="label-title">التعيين في الرتبة</label><input type="date" name="rankAppointmentDate" value={formData.rankAppointmentDate} onChange={handleChange} /></div>
                                                </div>
                                                <div><label className="label-title">الصنف والدرجة</label><input type="text" name="currentGrade" value={formData.currentGrade} onChange={handleChange} /></div>
                                                <div className="grid grid-cols-2 gap-2">
                                                    <div><label className="label-title">رقم المرجع</label><input type="text" name="adminRefNum" value={formData.adminRefNum} onChange={handleChange} /></div>
                                                    <div><label className="label-title">تاريخ المرجع</label><input type="date" name="adminRefDate" value={formData.adminRefDate} onChange={handleChange} /></div>
                                                </div>
                                                <div><label className="label-title">رقم هاتف الإدارة (إجباري)</label><input type="text" name="adminPhone" required={formData.isEmployed} value={formData.adminPhone} onChange={handleChange} /></div>
                                                <div className="md:col-span-2"><label className="label-title">عنوان الإدارة الحالي (إجباري)</label><input type="text" name="adminAddress" required={formData.isEmployed} value={formData.adminAddress} onChange={handleChange} /></div>
                                            </>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {step === 6 && (
                            <div className="animate-fade-in space-y-6">
                                <div className="form-section">
                                    <h2 className="section-header">8. مراجعة وتأكيد البريد والملفات</h2>
                                    <div className="grid grid-cols-1 gap-6">
                                        <div><label className="label-title">البريد الإلكتروني الشخصي (هام جداً للرد)</label><input type="email" name="email" required value={formData.email} onChange={handleChange} /></div>
                                        <div className="border-t pt-4">
                                            <h3 className="font-bold mb-4 text-gray-700 underline">الوثائق التي سيتم التأشير عليها تلقائياً بناءً على بياناتك:</h3>
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-2">
                                                {["بطاقة الإقامة", "وثيقة الخدمة الوطنية", "نسخة من الشهادة (المؤهل)", "كشوف النقاط للمسار الدراسي", "شهادات العمل (الخبرة)", "ملف المنشورات والشهادات العليا", "ترخيص المشاركة (للموظفين)"].map(doc => (
                                                    <label key={doc} className={`flex items-center gap-3 p-4 border rounded-lg transition ${formData.attachedDocs.includes(doc) ? 'bg-green-50 border-green-600 shadow-sm' : 'bg-gray-50 border-gray-200 opacity-60'}`}>
                                                        <input type="checkbox" checked={formData.attachedDocs.includes(doc)} readOnly className="w-5 h-5" />
                                                        <span className={`text-sm font-bold ${formData.attachedDocs.includes(doc) ? 'text-green-800' : 'text-gray-500'}`}>{doc}</span>
                                                    </label>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        <div className="flex justify-between items-center py-6">
                            {step > 1 && <button type="button" onClick={() => setStep(step - 1)} className="bg-gray-300 text-gray-800 px-10 py-4 rounded-xl font-black hover:bg-gray-400">السابق</button>}
                            {step < 6 ? (
                                <button type="button" onClick={() => setStep(step + 1)} className="mr-auto bg-blue-600 text-white px-10 py-4 rounded-xl font-black hover:bg-blue-700 shadow-lg">التالي</button>
                            ) : (
                                <button type="submit" disabled={isSubmitting} className={`mr-auto px-12 py-4 rounded-xl font-black transition-all ${isSubmitting ? 'bg-gray-400' : 'bg-green-600 text-white hover:bg-green-700 shadow-xl'}`}>
                                    {isSubmitting ? 'جاري الإرسال...' : 'إرسال الملف النهائي'}
                                </button>
                            )}
                        </div>
                    </form>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
