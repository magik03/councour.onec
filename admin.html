<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø£Ø¯Ù…Ù† - Ø±Ø§Ø¨Ø·Ø© Ø§Ù„Ø£ØºÙˆØ§Ø· ÙˆÙˆØ±Ù‚Ù„Ø©</title>
    <link rel="icon" href="https://i.top4top.io/p_3636li6n50.jpg">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Tajawal', sans-serif; background: #f4f6f8; margin: 0; min-height: 100vh; padding: 10px; padding-bottom: 80px; }
        
        #login-screen { display: flex; flex-direction: column; height: 90vh; justify-content: center; max-width: 400px; margin: 0 auto; }
        .logo-header { width: 80px; height: 80px; border-radius: 50%; border: 3px solid #27ae60; margin: 0 auto 15px; display: block; object-fit: cover; }
        .card { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 20px; border: 1px solid #e1e4e8; }
        
        input, select { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Tajawal'; font-size: 16px; background: #fff; }
        button { width: 100%; padding: 12px; background: #27ae60; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1rem; }
        
        .edit-card { background: #fff; border: 1px solid #ccc; border-radius: 10px; padding: 10px; margin-bottom: 15px; border-top: 5px solid #3498db; }
        .section-label { font-size: 0.8rem; color: #7f8c8d; font-weight: bold; margin-bottom: 5px; margin-top: 10px; border-bottom: 1px dashed #eee; }
        
        .team-select-row { display: flex; align-items: center; gap: 5px; margin-bottom: 5px; }
        .team-img-small { width: 40px; height: 40px; border-radius: 5px; object-fit: contain; border: 1px solid #eee; background: #f9f9f9; }
        
        .timer-controls { display: flex; gap: 5px; align-items: center; background: #f0f8ff; padding: 10px; border-radius: 8px; border: 1px solid #bcdff1; }
        .btn-start { background: #27ae60; padding: 8px; font-size: 0.9rem; }
        .btn-stop { background: #e74c3c; padding: 8px; font-size: 0.9rem; }
        .time-display { font-size: 1.2rem; font-weight: bold; width: 60px; text-align: center; border: 2px solid #333; border-radius: 5px; background: #fff; color: #333; }

        .score-edit-row { display: flex; justify-content: center; align-items: center; gap: 10px; background: #f8f9fa; padding: 10px; border-radius: 8px; margin: 10px 0; }
        .score-input { width: 60px !important; text-align: center; font-size: 1.5rem; font-weight: bold; margin: 0; border: 2px solid #ddd; }
        
        .btns-row { display: flex; gap: 10px; margin-top: 15px; }
        .btn-save { background: #2980b9; flex: 2; }
        .btn-del { background: #c0392b; flex: 1; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="card" style="text-align:center;">
            <img src="https://i.top4top.io/p_3636li6n50.jpg" class="logo-header">
            <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
            <input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" style="direction: ltr;">
            <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="direction: ltr;">
            <button id="btnLogin">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <div id="dashboard" style="display:none; max-width: 600px; margin: 0 auto;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <h3 style="margin:0;">Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</h3>
            <button onclick="window.location.reload()" style="width:auto; background:#7f8c8d; padding:5px 15px; font-size:0.9rem;">ØªØ­Ø¯ÙŠØ«</button>
        </div>

        <!-- Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ø§Ø±Ø§Ø© -->
        <div class="card" style="border: 1px solid #27ae60;">
            <h3 style="margin-top:0; color:#27ae60; font-size:1rem;">+ Ù†Ø´Ø± Ù…Ø¨Ø§Ø±Ø§Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            
            <select id="newLeague" onchange="updateClubsList()">
                <option value="" disabled selected>-- Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø£ÙˆÙ„Ø§Ù‹ --</option>
                <option value="Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø£ÙˆÙ„ (ÙÙˆØ¬ Ø£)">Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø£ÙˆÙ„ (ÙÙˆØ¬ Ø£)</option>
                <option value="Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø£ÙˆÙ„ (ÙÙˆØ¬ Ø¨)">Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø£ÙˆÙ„ (ÙÙˆØ¬ Ø¨)</option>
                <option value="Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ (ÙÙˆØ¬ Ø¬)">Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ (ÙÙˆØ¬ Ø¬)</option>
                <option value="Ù‚Ø³Ù… Ù…Ø§ Ø¨ÙŠÙ† Ø§Ù„Ø±Ø§Ø¨Ø·Ø§Øª">Ù‚Ø³Ù… Ù…Ø§ Ø¨ÙŠÙ† Ø§Ù„Ø±Ø§Ø¨Ø·Ø§Øª (Ø§Ù„Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø´Ø±Ù‚ÙŠ)</option>
                <option value="Ø´Ø±ÙÙŠ Ø§Ù„Ø£ØºÙˆØ§Ø·">Ø´Ø±ÙÙŠ Ø§Ù„Ø£ØºÙˆØ§Ø·</option>
                <option value="ÙˆÙ„Ø§Ø¦ÙŠ Ø§Ù„Ø£ØºÙˆØ§Ø·">ÙˆÙ„Ø§Ø¦ÙŠ Ø§Ù„Ø£ØºÙˆØ§Ø·</option>
                <option value="ÙƒØ£Ø³ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±ÙŠØ©">ÙƒØ£Ø³ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© ğŸ†</option>
            </select>
            
            <input type="text" id="newRound" placeholder="Ø§Ù„Ø¬ÙˆÙ„Ø© (Ù…Ø«Ø§Ù„: 14)">
            
            <div style="display:flex; gap:10px;">
                <select id="newHome" class="club-select"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø£Ø¹Ù„Ø§Ù‡ â˜ï¸</option></select>
                <select id="newAway" class="club-select"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø£Ø¹Ù„Ø§Ù‡ â˜ï¸</option></select>
            </div>
            <button id="btnAdd">Ù†Ø´Ø± Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</button>
        </div>

        <h3 style="margin-bottom:10px;">Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ø¬Ø§Ø±ÙŠØ©:</h3>
        <div id="matches-list"></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, addDoc, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // âš ï¸âš ï¸ Ø¶Ø¹ ÙƒÙˆØ¯ Firebase Config Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ âš ï¸âš ï¸
        const firebaseConfig = {
          apiKey: "AIzaSyAXLSZ5OqPEOnP0DUx3w75fU2xxiVkrWcE",
          authDomain: "koooralaghouat.firebaseapp.com",
          projectId: "koooralaghouat",
          storageBucket: "koooralaghouat.firebasestorage.app",
          messagingSenderId: "84750708348",
          appId: "1:84750708348:web:179ec7acf8fc2f357e23f9",
          measurementId: "G-4YSP7SWPGV"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ==========================================
        // ğŸŸ¢ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ© (ÙƒØ§Ù…Ù„Ø©)
        // ==========================================
        window.leaguesData = {
            "Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø£ÙˆÙ„ (ÙÙˆØ¬ Ø£)": [
                { name: "Ø´ Ø¨ Ø¹ÙŠÙ† Ø§Ù…ÙŠÙ†Ø§Ø³", logo: "https://lrfouargla.com/uploads/images/logos/1(1).png" },
                { name: "Ù†.Ø±.ØªÙ‚Ù†ØªÙˆØ±ÙŠÙ†", logo: "https://lrfouargla.com/uploads/images/logos/203-1601155957.png" },
                { name: "Ø§ØªØ­Ø§Ø¯ Ø§Ù„ØºØ±Ø§Ø¨Ø©", logo: "https://lrfouargla.com/uploads/images/logos/sssx.png" },
                { name: "Ù… .Ø´Ø¨Ø§Ø¨ .Ø§Ù„Ù…Ø®Ø§Ø¯Ù…Ø©", logo: "https://lrfouargla.com/uploads/images/logos/sz.png" },
                { name: "Ø¥ØªØ­Ø§Ø¯ Ø¨Ø±ÙŠØ§Ù†", logo: "https://lrfouargla.com/uploads/images/logos/47.png" },
                { name: "ØªØ±Ø¬ÙŠ ØªÙ‚Ø¯ÙŠØ¯ÙŠÙ†", logo: "https://lrfouargla.com/uploads/images/logos/133.png" },
                { name: "Ùˆ.Ø±.Ø¨.Ø§Ù„Ø¯Ø¨ÙŠÙ„Ø©", logo: "https://lrfouargla.com/uploads/images/logos/qqqqqq.png" },
                { name: "Ù†Ø§Ø¯ÙŠ Ø¨ÙˆØºÙØ§Ù„Ø©", logo: "https://lrfouargla.com/uploads/images/logos/23.png" },
                { name: "Ø§Ù„Ù…Ù†Ø¸Ø± Ø§Ù„Ø¬Ù…ÙŠÙ„", logo: "https://lrfouargla.com/uploads/images/logos/CSBV%20(1).png" },
                { name: "Ù….Ùƒ.Ø£Ù…Ù„ Ø§Ù„Ù†Ø²Ù„Ø©", logo: "https://lrfouargla.com/uploads/images/logos/sss%20%E2%80%AB%E2%80%AC.png" },
                { name: "Ø¥ØªØ­Ø§Ø¯ Ø§Ù„Ø±Ø¨Ø§Ø­", logo: "https://lrfouargla.com/uploads/images/logos/73.png" },
                { name: "Ø´Ø¨Ø§Ø¨ Ø³ÙŠØ¯ÙŠ Ø¨ÙˆØ¹Ø²ÙŠØ²", logo: "https://lrfouargla.com/uploads/images/logos/13.png" },
                { name: "Ø´Ø¨Ø§Ø¨ Ù‚ØµØ± Ø§Ù„Ø­ÙŠØ±Ø§Ù†", logo: "https://lrfouargla.com/uploads/images/logos/54.png" },
                { name: "Ø¥ØªØ­Ø§Ø¯ Ø­Ø§Ø³ÙŠ Ø§Ù„Ø¯Ù„Ø§Ø¹Ø©", logo: "https://lrfouargla.com/uploads/images/logos/53.png" }
            ],
            
            "Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø£ÙˆÙ„ (ÙÙˆØ¬ Ø¨)": [
                { name: "Ø´Ø¨Ø§Ø¨ Ù‚ØµØ± ÙˆØ±Ù‚Ù„Ø©", logo: "https://lrfouargla.com/uploads/images/logos/15826488_199664807171500_3091424271281007906_n.gif" },
                { name: "ÙˆÙØ§Ù‚ Ø§Ù„Ù…ØºÙŠØ±", logo: "https://lrfouargla.com/uploads/images/logos/111.png" },
                { name: "Ø§ØªØ­Ø§Ø¯ .Ø±. Ø¨.Ø§Ù„Ø£ØºÙˆØ§Ø·", logo: "https://lrfouargla.com/uploads/images/logos/IMG-20241109-WA0007.jpg" },
                { name: "ÙˆÙØ§Ù‚ Ø¹ÙŠÙ† Ù…Ø§Ø¶ÙŠ", logo: "https://lrfouargla.com/uploads/images/logos/125.png" },
                { name: "Ø£Ù…Ù„ Ø³ÙˆÙ", logo: "https://lrfouargla.com/uploads/images/logos/88.png" },
                { name: "Ø´Ø¨Ø§Ø¨ Ù†Ù‡Ù‚Ø§Ø±", logo: "https://lrfouargla.com/uploads/images/logos/102.png" },
                { name: "Ù‡Ù„Ø§Ù„ ØºØ±Ø¯Ø§ÙŠØ©", logo: "https://lrfouargla.com/uploads/images/logos/75.png" },
                { name: "Ø§Ù„ØªØ¶Ø§Ù…Ù† Ø§Ù„Ø³ÙˆÙÙŠ", logo: "https://lrfouargla.com/uploads/images/logos/72.png" },
                { name: "Ø¥. Ø§Ù„Ø±Ø¨Ø§Ø¶ÙŠ Ø§Ù„Ù…Ù†ÙŠØ¹ÙŠ", logo: "https://lrfouargla.com/uploads/images/logos/WhatsApp%20Image%202025-10-25%20%C3%A0%2022.02.03_23b4051f.jpg" },
                { name: "Ø´.Ø£.ØªÙ…Ù†Ø±Ø§Ø³Øª", logo: "https://lrfouargla.com/uploads/images/logos/100.png" },
                { name: "Ø¥ØªØ­Ø§Ø¯ Ø¹ÙŠÙ† Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡", logo: "https://lrfouargla.com/uploads/images/logos/40.png" },
                { name: "ÙˆÙØ§Ù‚ Ù…Ù‚Ø±", logo: "https://lrfouargla.com/uploads/images/logos/38.png" },
                { name: "Ø¥.Ø§Ù„Ø­Ù…Ø§Ø¯ÙŠÙ†", logo: "https://lrfouargla.com/uploads/images/logos/168-1531611858.png" },
                { name: "Ù†Ø¬Ù… Ø¨ÙˆØºÙØ§Ù„Ø©", logo: "https://lrfouargla.com/uploads/images/logos/NRNBO-02.png" }
            ],

            "Ø§Ù„Ø¬Ù‡ÙˆÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ (ÙÙˆØ¬ Ø¬)": [
                { name: "Ù… .Ø´ .Ø§Ù„Ø«Ù†ÙŠØ© ØºØ±Ø¯Ø§ÙŠØ©", logo: "https://lrfouargla.com/uploads/images/logos/449-1634476753.png" },
                { name: "Ù…ÙˆÙ„ÙˆØ¯ÙŠØ© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡", logo: "https://lrfouargla.com/uploads/images/logos/46.png" },
                { name: "Ø±Ø§Ø¦Ø¯ Ø§Ù„Ù…Ù†ÙŠØ¹Ø©", logo: "https://lrfouargla.com/uploads/images/logos/7.png" },
                { name: "Ø¨Ù† Ù†Ø§ØµØ± Ø¨Ù† Ø´Ù‡Ø±Ø©", logo: "https://lrfouargla.com/uploads/images/logos/49(1).png" },
                { name: "Ø¥.Ø¶Ø§ÙŠØ© Ø¨Ù† Ø¶Ø­ÙˆØ©", logo: "https://lrfouargla.com/uploads/images/logos/57(1).png" },
                { name: "Ù…Ø³ØªÙ‚Ø¨Ù„ Ù„Ù…Ø§Ø¶ÙŠ", logo: "https://lrfouargla.com/uploads/images/logos/56.png" },
                { name: "Ø±Ø§Ø¦Ø¯ Ø­Ø§Ø³ÙŠ Ø§Ù„Ù‚Ø§Ø±Ø©", logo: "https://lrfouargla.com/uploads/images/logos/134.png" },
                { name: "Ø¹ÙŠÙ† Ø³ÙŠØ¯ÙŠ Ø¹Ù„ÙŠ", logo: "https://lrfouargla.com/uploads/images/logos/1528-1663416912.png" },
                { name: "Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø£ØºÙˆØ§Ø·", logo: "https://lrfouargla.com/uploads/images/logos/50.png" },
                { name: "Ø¥ØªØ­Ø§Ø¯ ØªØ§Ø¬Ù…ÙˆØª", logo: "https://lrfouargla.com/uploads/images/logos/nirbt.png" },
                { name: "Ø§ØªØ­Ø§Ø¯.Ø¨Ø±ÙŠØ¯Ø©", logo: "https://lrfouargla.com/uploads/images/logos/2174-1665949908.png" },
                { name: "ØªØ±Ø¬ÙŠ Ù…Ø±Ù…Ø§Ø¯", logo: "https://lrfouargla.com/uploads/images/logos/51.png" },
                { name: "ÙˆØ¯Ø§Ø¯ Ø²Ù„ÙØ§Ù†Ø©", logo: "https://lrfouargla.com/uploads/images/logos/t%C3%A9l%C3%A9chargement%20(1).jpg" },
                { name: "Ø§Ù„Ø§Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠ Ø§Ù„Ù‚Ø±Ø§Ø±Ø©", logo: "https://lrfouargla.com/uploads/images/logos/IMG-20231119-WA0010.jpg" },
                { name: "Ø£Ù…Ù„ Ø³ÙŠØ¯ÙŠ Ø¨ÙˆØ²ÙŠØ¯", logo: "https://lrfouargla.com/uploads/images/logos/49.png" },
                { name: "Ø§ØªØ­Ø§Ø¯ Ø´Ø¨Ø§Ø¨ ØªØ§ØºÙŠØª", logo: "https://lrfouargla.com/uploads/images/logos/1855-1664293222.png" }
            ],

            "Ù‚Ø³Ù… Ù…Ø§ Ø¨ÙŠÙ† Ø§Ù„Ø±Ø§Ø¨Ø·Ø§Øª": [
                { name: "Ø¥ØªØ­Ø§Ø¯ Ø§Ù„Ù†Ø²Ù„Ø©", logo: "https://lirf.org.dz/uploads/images/logos/3.png" },
                { name: "Ù†Ø§Ø¯ÙŠ ØªÙ‚Ø±Øª", logo: "https://lirf.org.dz/uploads/images/logos/received_257439396802495.jpeg" },
                { name: "Ø£ Ù…ØªÙ„ÙŠÙ„ÙŠ Ø§Ù„Ø´Ø¹Ø§Ù†Ø¨Ø©", logo: "https://lirf.org.dz/uploads/images/logos/5.png" },
                { name: "Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø®Ù†Ù‚", logo: "https://lirf.org.dz/uploads/images/logos/IRBKheneg.png" },
                { name: "Ø¥ØªØ­Ø§Ø¯ Ø§Ù„Ø²Ø§ÙˆÙŠØ©", logo: "https://lirf.org.dz/uploads/images/logos/6.png" },
                { name: "Ø§ØªØ­Ø§Ø¯ Ø¢ÙÙ„Ùˆ", logo: "https://lirf.org.dz/uploads/images/logos/407-1656244680.png" },
                { name: "Ø¥ØªØ­Ø§Ø¯ Ù‡Ù…Ø§ÙŠØ³Ø©", logo: "https://lirf.org.dz/uploads/images/logos/102.png" },
                { name: "Ù…Ø´Ø¹Ù„ Ø­Ø§Ø³ÙŠ Ù…Ø³Ø¹ÙˆØ¯", logo: "https://lirf.org.dz/uploads/images/logos/13.png" },
                { name: "Ø´Ø¨Ø§Ø¨ Ø¬Ø§Ù…Ø¹Ø©", logo: "https://lirf.org.dz/uploads/images/logos/39(1).png" },
                { name: "Ø±Ø§Ø¦Ø¯ Ù‚Ù„ØªØ©Ø³ Ø³Ø¹Ø¯", logo: "https://lirf.org.dz/uploads/images/logos/Gueltet%20Sidi%20Saad.png" },
                { name: "Ø§ÙˆÙ„Ù…Ø¨ÙŠ Ø§Ù„ÙˆØ§Ø¯", logo: "https://lirf.org.dz/uploads/images/logos/Olympique%20El-Oued.png" },
                { name: "Ø£ÙˆÙ„Ù…Ø¨ÙŠÙƒ Ø§Ù„Ù…Ù‚Ø±Ù†", logo: "https://lirf.org.dz/uploads/images/logos/8.png" },
                { name: "Ù†Ø¬ÙˆÙ… Ø§Ù„ÙŠØ²ÙŠ", logo: "https://lirf.org.dz/uploads/images/logos/16.png" },
                { name: "Ø¥ØªØ­Ø§Ø¯ Ø­Ø§Ø³ÙŠ Ø§Ù„Ø±Ù…Ù„", logo: "https://lirf.org.dz/uploads/images/logos/12.png" },
                { name: "Ø§ØªØ­Ø§Ø¯ Ø³ÙˆÙ", logo: "https://lirf.org.dz/uploads/images/logos/412-1715352850.png" },
                { name: "Ø§ØªØ­Ø§Ø¯ ÙˆØ±Ù‚Ù„Ø©", logo: "https://lirf.org.dz/uploads/images/logos/414-1662939264.png" }
            ],

            "default": [
                { name: "ÙØ±ÙŠÙ‚ 1", logo: "" },
                { name: "ÙØ±ÙŠÙ‚ 2", logo: "" }
            ]
        };

        // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„ÙØ±Ù‚
        window.updateClubsList = () => {
            const league = document.getElementById('newLeague').value;
            const homeSelect = document.getElementById('newHome');
            const awaySelect = document.getElementById('newAway');
            
            homeSelect.innerHTML = '<option value="">Ø§Ù„Ù…Ø³ØªØ¶ÙŠÙ (ÙŠÙ…ÙŠÙ†)</option>';
            awaySelect.innerHTML = '<option value="">Ø§Ù„Ø¶ÙŠÙ (ÙŠØ³Ø§Ø±)</option>';

            const clubs = window.leaguesData[league] || window.leaguesData["default"];

            clubs.forEach(club => {
                const opt1 = document.createElement('option');
                opt1.value = club.name;
                opt1.innerText = club.name;
                opt1.setAttribute('data-logo', club.logo);
                homeSelect.appendChild(opt1);

                const opt2 = document.createElement('option');
                opt2.value = club.name;
                opt2.innerText = club.name;
                opt2.setAttribute('data-logo', club.logo);
                awaySelect.appendChild(opt2);
            });
        };

        const getLogoFromSelect = (selectId) => {
            const select = document.getElementById(selectId);
            const selectedOption = select.options[select.selectedIndex];
            return selectedOption.getAttribute('data-logo') || 'https://cdn-icons-png.flaticon.com/512/53/53283.png';
        };

        onAuthStateChanged(auth, (user) => {
            document.getElementById('login-screen').style.display = user ? 'none' : 'flex';
            document.getElementById('dashboard').style.display = user ? 'block' : 'none';
            if(user) {
                loadMatches();
            }
        });

        document.getElementById('btnLogin').addEventListener('click', () => {
            signInWithEmailAndPassword(auth, document.getElementById('email').value, document.getElementById('password').value)
            .catch(e => alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„"));
        });

        document.getElementById('btnAdd').addEventListener('click', async () => {
            const league = document.getElementById('newLeague').value;
            const round = document.getElementById('newRound').value;
            const home = document.getElementById('newHome').value;
            const away = document.getElementById('newAway').value;
            
            if(league && home && away) {
                const homeLogo = getLogoFromSelect('newHome');
                const awayLogo = getLogoFromSelect('newAway');

                if(confirm("Ù†Ø´Ø± Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©ØŸ")) {
                    await addDoc(collection(db, "matches"), {
                        league, round, home, away, 
                        homeLogo, awayLogo,
                        scoreH: 0, scoreA: 0, scorersH: "", scorersA: "", 
                        status: "Ù„Ù… ØªØ¨Ø¯Ø£", 
                        time: 0, isRunning: false, lastStartTime: null
                    });
                    alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± âœ…");
                }
            } else {
                alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© ÙˆØ§Ù„ÙØ±ÙŠÙ‚ÙŠÙ†");
            }
        });

        function loadMatches() {
            onSnapshot(collection(db, "matches"), (snapshot) => {
                const list = document.getElementById('matches-list');
                list.innerHTML = '';
                snapshot.forEach((d) => {
                    const m = d.data();
                    const id = d.id;
                    const sel = (val) => m.status === val ? 'selected' : '';

                    let displayTime = m.time;
                    if(m.isRunning && m.lastStartTime) {
                        const now = Date.now();
                        const diffMins = Math.floor((now - m.lastStartTime) / 60000);
                        displayTime = parseInt(m.time) + diffMins;
                    }

                    list.innerHTML += `
                    <div class="edit-card">
                        <div style="text-align:center; font-weight:bold; color:#888; margin-bottom:10px;">
                            ${m.league} (${m.round})
                        </div>

                        <div class="section-label">Ø§Ù„ÙØ±Ù‚ (ÙŠÙ…ÙŠÙ†: Ù…Ø³ØªØ¶ÙŠÙ / ÙŠØ³Ø§Ø±: Ø¶ÙŠÙ)</div>
                        <div class="team-select-row">
                            <img src="${m.homeLogo}" class="team-img-small">
                            <input type="text" value="${m.home}" disabled style="background:#eee; font-weight:bold;">
                        </div>
                        
                        <div class="score-edit-row">
                            <input type="number" id="sH-${id}" value="${m.scoreH}" class="score-input">
                            <span style="font-weight:bold; color:#aaa;">-</span>
                            <input type="number" id="sA-${id}" value="${m.scoreA}" class="score-input">
                        </div>

                        <div class="team-select-row">
                            <img src="${m.awayLogo}" class="team-img-small">
                            <input type="text" value="${m.away}" disabled style="background:#eee; font-weight:bold;">
                        </div>

                         <input type="text" id="scH-${id}" value="${m.scorersH || ''}" placeholder="Ù‡Ø¯Ø§ÙÙŠ Ø§Ù„Ù…Ø³ØªØ¶ÙŠÙ" style="font-size:0.8rem; margin-top:5px;">
                         <input type="text" id="scA-${id}" value="${m.scorersA || ''}" placeholder="Ù‡Ø¯Ø§ÙÙŠ Ø§Ù„Ø¶ÙŠÙ" style="font-size:0.8rem; margin-top:5px;">

                        <div class="section-label">Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙˆÙ‚Øª</div>
                        <div class="timer-controls">
                            <button class="btn-start" onclick="window.toggleTimer('${id}', true, ${displayTime})" ${m.isRunning ? 'disabled style="opacity:0.5"' : ''}>ØªØ´ØºÙŠÙ„ â–·</button>
                            <input type="number" id="tm-${id}" value="${displayTime}" class="time-display">
                            <button class="btn-stop" onclick="window.toggleTimer('${id}', false, ${displayTime})" ${!m.isRunning ? 'disabled style="opacity:0.5"' : ''}>Ø¥ÙŠÙ‚Ø§Ù â¸</button>
                        </div>
                        
                        <div style="margin-top:10px;">
                            <select id="st-${id}" style="font-weight:bold;">
                                <option value="Ù„Ù… ØªØ¨Ø¯Ø£" ${sel("Ù„Ù… ØªØ¨Ø¯Ø£")}>âšª Ù„Ù… ØªØ¨Ø¯Ø£</option>
                                <option value="Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø£ÙˆÙ„" ${sel("Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø£ÙˆÙ„")}>ğŸŸ¢ Ø§Ù„Ø´ÙˆØ· 1</option>
                                <option value="Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø£ÙˆÙ„" ${sel("Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø£ÙˆÙ„")}>ğŸŸ  Ø§Ø³ØªØ±Ø§Ø­Ø©</option>
                                <option value="Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø«Ø§Ù†ÙŠ" ${sel("Ø§Ù„Ø´ÙˆØ· Ø§Ù„Ø«Ø§Ù†ÙŠ")}>ğŸŸ¢ Ø§Ù„Ø´ÙˆØ· 2</option>
                                <option value="Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©" ${sel("Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©")}>âš« Ø§Ù†ØªÙ‡Øª</option>
                            </select>
                        </div>

                        <div class="btns-row">
                            <button class="btn-save" onclick="window.upd('${id}', ${m.isRunning})">Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ğŸ’¾</button>
                            <button class="btn-del" onclick="window.del('${id}')">Ø­Ø°Ù</button>
                        </div>
                    </div>`;
                });
            });
        }

        window.toggleTimer = async (id, start, currentTime) => {
            const timeVal = Number(document.getElementById(`tm-${id}`).value);
            if(start) {
                await updateDoc(doc(db, "matches", id), {
                    isRunning: true, lastStartTime: Date.now(), time: timeVal
                });
            } else {
                await updateDoc(doc(db, "matches", id), {
                    isRunning: false, lastStartTime: null, time: timeVal
                });
            }
        };

        window.upd = async (id, isRunning) => {
            let updateData = {
                scoreH: Number(document.getElementById(`sH-${id}`).value),
                scoreA: Number(document.getElementById(`sA-${id}`).value),
                scorersH: document.getElementById(`scH-${id}`).value,
                scorersA: document.getElementById(`scA-${id}`).value,
                status: document.getElementById(`st-${id}`).value,
            };
            if (!isRunning) {
                updateData.time = Number(document.getElementById(`tm-${id}`).value);
            }
            await updateDoc(doc(db, "matches", id), updateData);
            alert("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« âœ…");
        };
        
        window.del = async (id) => { if(confirm("Ø­Ø°ÙØŸ")) await deleteDoc(doc(db, "matches", id)); };
    </script>
</body>
</html>